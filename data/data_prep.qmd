```{r}
library(tidyverse)
library(janitor)
```

```{r}
dem24_primary <- read_csv("PP24_AllPrecinctsDemocratic.csv") |> clean_names()
rep24_primary <- read_csv("PP24_AllPrecinctsRepublican.csv") |> clean_names()

all_primary <- bind_rows(dem24_primary, rep24_primary)
```

```{r}
maryland_primary_2024 <- all_primary |> group_by(county_name, office_name, office_district, candidate_name, party) |> 
  summarize(early_voting = sum(early_votes), election_day = sum(election_night_votes), absentee = sum(mail_in_ballot_1_votes), provisional = sum(provisional_votes), second_absentee = sum(mail_in_ballot_2_votes)) |> mutate(votes = early_voting + election_day + absentee + provisional + second_absentee)
```

Need to remove records with an office_district value that are not U.S. Congress.

```{r}
non_congress <- maryland_primary_2024 |> filter(is.na(office_district)) |> filter(!office_name == 'U.S. Congress')

congress <- maryland_primary_2024 |> filter(!is.na(office_district)) |> filter(office_name == 'U.S. Congress')

federal <- bind_rows(congress, non_congress)

write_csv(federal, "maryland_primary_2024.csv")

```

```{r}
winred_q2 <- read_csv("~/code/aosc247/sa1800865.csv.zip")
```

```{r}
wv_winred <- winred_q2 |> filter(state == "WV")
write_rds(wv_winred, "~/code/datajournalismbook-elections/labs/lab_01/lab_01.rds")
```


```{r}
md_contribs <- read_csv("~/Downloads/mdcontribs.csv") |> filter(entity_type == 'IND', recipient_committee_type == 'H')
```
```{r}
precinct_voting_locations <- read_csv("~/code/datajournalismbook-elections/data/md_polling_places_p24.csv") |> clean_names() |> mutate(election_district_precinct = str_remove(election_district_precinct_part, "-\\d+$")) |> select(-poll_id, -election_district_precinct_part, -municipalities, -board_of_education_district, -orphans_court_district, -commissioner_district) |> distinct()
```

```{r}
write_csv(precinct_voting_locations, "~/code/datajournalismbook-elections/labs/lab_04/data/md_precinct_voting_locations.csv")
```

